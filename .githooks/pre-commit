#!/usr/bin/env bash
set -euo pipefail

metadata_files=()
while IFS= read -r line; do
  metadata_files+=("$line")
done < <(git diff --cached --name-only --diff-filter=ACM -- _thoughts/*.md)
while IFS= read -r line; do
  metadata_files+=("$line")
done < <(git diff --cached --name-only --diff-filter=ACM -- _interviews/*.md)

if [[ "${#metadata_files[@]}" -eq 0 ]]; then
  exit 0
fi

bin/enrich-metadata update "${metadata_files[@]}"
